
testthat::context("Utils")


testthat::test_that("Determining parsing format to use for date character vectors", {
  
  dates_1 <- c('24.04.2006', '17.12.2011', '10.11.2010', '27.02.2016', '04.01.2011',
               '10.12.2019', '02.04.2014', '21.08.2005', '31.07.2005', '02.07.2000',
               '23.11.2000', '13.04.2019', '08.12.2002', '21.06.2000', '23.12.2008',
               '17.07.2004', '20.08.2000', '31.01.2000', '01.02.2012', '10.02.2012')
  
  dates_2 <- c('3/29/2019', '6/14/2009', '5/17/2008', '4/8/2007', '8/8/2006',
               '3/23/2018', '1/17/2003', '12/10/2017', '9/25/2010', '3/13/2002',
               '1/23/2018', '9/17/2000', '5/24/2007', '10/15/2008', '4/9/2015',
               '2/18/2010', '3/26/2003', '7/16/2015', '4/7/2004', '7/13/2011')
  
  dates_3 <- c(
    '2012-03-27T00:22:22Z', '2002-11-14T09:03:19Z', '2008-10-18T19:57:58Z', '2012-05-06T05:42:33Z',
    '2018-10-25T15:42:42Z', '2004-01-12T02:01:59Z', '2015-06-25T18:33:55Z', '2004-01-06T14:28:33Z',
    '2007-05-13T09:23:03Z', '2012-06-08T10:27:38Z', '2006-03-21T08:04:54Z', '2006-10-25T09:19:14Z',
    '2011-12-13T23:16:26Z', '2010-01-13T10:33:08Z', '2015-01-12T23:23:36Z', '2002-08-05T22:38:47Z',
    '2001-04-30T11:18:52Z', '2001-09-18T13:29:37Z', '2008-04-26T13:48:15Z', '2013-01-29T18:22:56Z')
  
  
  
  testthat::expect_equal(find_parser(c(dates_1, rep(NA, 10))), lubridate::dmy)
  testthat::expect_equal(find_parser(c(dates_2, rep(NA, 10))), lubridate::mdy)
  testthat::expect_equal(find_parser(c(dates_3, rep(NA, 10))), lubridate::ymd_hms)
  testthat::expect_equal(find_parser(NULL), function(x) return (x))
  
  
})